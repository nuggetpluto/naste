{% extends "base.html" %}
{% block content %}

<h2>Добавить медосмотр</h2>

<form method="post" action="/medical/add">

    <label>Животное:</label><br>
    <select name="animal_id" required>
        <option value="">Выберите животное</option>
        {% for a in animals %}
        <option value="{{ a.id }}">{{ a.name }} ({{ a.species }})</option>
        {% endfor %}
    </select>
    <br><br>

    <label>Сотрудник:</label><br>
    <select name="employee_id" required>
        <option value="">Выберите сотрудника</option>
        {% for e in employees %}
        <option value="{{ e.id }}">{{ e.full_name }}</option>
        {% endfor %}
    </select>
    <br><br>

    <label>Диагноз:</label><br>
    <select name="diagnosis" id="diagnosis" required onchange="toggleTreatment()">
        <option value="Здоров">Здоров</option>
        <option value="Болен">Болен</option>
        <option value="На лечении">На лечении</option>
    </select>
    <br><br>

    <div id="treatment-block" style="display:none;">
        <label>Назначенное лечение:</label><br>
        <input type="text" name="treatment" placeholder="Введите лечение">
        <br><br>
    </div>

    <label>Дата осмотра:</label><br>
    <input type="date" name="exam_date" required value="{{ now().strftime('%Y-%m-%d') }}">
    <br><br>

    <button type="submit" class="btn">Сохранить</button>
</form>

<script>
function toggleTreatment() {
    const diag = document.getElementById("diagnosis").value;
    const block = document.getElementById("treatment-block");

    if (diag === "Здоров") {
        block.style.display = "none";
    } else {
        block.style.display = "block";
    }
}
</script>

{% endblock %}